<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>12</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: black;
}
.container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
}
/* jpg / png は画面ぴったり */
#jpgLayer, #pngLayer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  object-fit: fill;
}
/* gif は縦を合わせて左端からスタート */
#gifLayer {
  position: absolute;
  top: 0;
  left: 0;
  height: 100vh;
  width: auto;
  object-fit: contain;
  z-index: 1;
  transition: left 6s cubic-bezier(0,0,0.2,1);
  pointer-events: none;
}
/* レイヤー順 */
#jpgLayer { z-index: 0; }
#pngLayer { z-index: 2; }
/* ボタン */
.button {
  position: absolute;
  top: 20px;
  padding: 10px 16px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  background: rgba(0, 0, 0, 0.6);
  color: #fff;
  cursor: pointer;
  z-index: 20;
}
#backButton { left: 20px; }
#nextButton { right: 20px; }
</style>
</head>
<body>
<div class="container" id="scene">
  <img src="12.jpg" id="jpgLayer" alt="jpg">
  <img src="12.gif" id="gifLayer" alt="gif">
  <img src="12.png" id="pngLayer" alt="png">
</div>
<button class="button" id="backButton" onclick="history.back()">戻る</button>
<button class="button" id="nextButton" onclick="location.href='13.html'">次へ</button>
<script>
(function () {
  const gif = document.getElementById('gifLayer');
  const scene = document.getElementById('scene');
  let moveState = 0; // 0:初期, 1:右端, 2:消えた
  const animationDurationSec = 6;

  // 初期位置リセット
  function resetGifPosition() {
    gif.src = "12.gif";
    gif.style.transition = 'none';
    gif.style.left = '0px';
    void gif.offsetWidth;
    gif.style.transition = `left ${animationDurationSec}s cubic-bezier(0,0,0.2,1)`;
    moveState = 0;
  }

  // 右に移動
  function animateGif() {
    if (moveState === 0) {
      // 1回目: 右端まで移動
      moveState = 1;
      gif.src = "12m.gif";
      const checkReady = setInterval(() => {
        if (gif.naturalWidth > 0) {
          clearInterval(checkReady);
          const scale = gif.getBoundingClientRect().height / gif.naturalHeight;
          const gifWidth = gif.naturalWidth * scale;
          const rightStop = window.innerWidth - gifWidth;
          gif.style.left = rightStop + 'px';
        }
      }, 100);
    } else if (moveState === 1) {
      // 2回目: 画面外右へ移動
      moveState = 2;
      gif.src = "12m.gif";
      const checkReady = setInterval(() => {
        if (gif.naturalWidth > 0) {
          clearInterval(checkReady);
          const scale = gif.getBoundingClientRect().height / gif.naturalHeight;
          const gifWidth = gif.naturalWidth * scale;
          const rightStop = window.innerWidth - gifWidth;
          // まず右端に一瞬で移動
          gif.style.transition = 'none';
          gif.style.left = rightStop + 'px';
          void gif.offsetWidth;
          gif.style.transition = `left ${animationDurationSec}s cubic-bezier(0,0,0.2,1)`;
          // 画面外右へ
          gif.style.left = window.innerWidth + 'px';
        }
      }, 100);
    }
  }

  // 初期設定
  window.addEventListener('load', resetGifPosition);
  window.addEventListener('resize', () => {
    if (moveState === 0) resetGifPosition();
  });

  // クリックやタッチで発動
  scene.addEventListener('click', (e) => {
    if (!e.target.closest('button')) animateGif();
  });
  scene.addEventListener('touchstart', (e) => {
    if (!e.target.closest('button')) animateGif();
  });
})();
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>12</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: black;
}

/* 全画面固定コンテナ */
.container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
}

/* jpg / png は画面ぴったり */
#jpgLayer, #pngLayer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  object-fit: fill;
}

/* gif は縦を合わせて左端からスタート */
#gifLayer {
  position: absolute;
  top: 0;
  left: -100vw;
  height: 100vh;
  width: auto;
  object-fit: contain;
  z-index: 1;
  transition: left 6s cubic-bezier(0,0,0.2,1);
  pointer-events: none;
}

/* レイヤー順 */
#jpgLayer { z-index: 0; }
#pngLayer { z-index: 2; }

/* ボタン */
.button {
  position: absolute;
  top: 20px;
  padding: 10px 16px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  background: rgba(0, 0, 0, 0.6);
  color: #fff;
  cursor: pointer;
  z-index: 20;
}
#backButton { left: 20px; }
#nextButton { right: 20px; }
</style>
</head>
<body>

<div class="container" id="scene">
  <img src="12.jpg" id="jpgLayer" alt="jpg">
  <img src="12a.png" id="slideLayer" alt="slide" style="position:absolute;top:0;left:-100vw;height:100vh;width:auto;object-fit:contain;z-index:3;transition:left 2s cubic-bezier(0,0,0.2,1);pointer-events:none;display:none;">
  <img src="12.gif" id="gifLayer" alt="gif">
  <img src="12.png" id="pngLayer" alt="png">
</div>

<button class="button" id="backButton" onclick="history.back()">戻る</button>
<button class="button" id="nextButton" onclick="location.href='13.html'">次へ</button>

<script>

(function () {
  const gif = document.getElementById('gifLayer');
  const slide = document.getElementById('slideLayer');
  const scene = document.getElementById('scene');
  const animationDurationSec = 6;
  let state = 0; // 0:初期, 1:12a.pngスライド, 2:gif右端, 3:gif消える

  function resetAll() {
    // 初期化
    gif.src = "12.gif";
    gif.style.transition = 'none';
    gif.style.left = '-100vw';
    void gif.offsetWidth;
    gif.style.transition = `left ${animationDurationSec}s cubic-bezier(0,0,0.2,1)`;
    slide.style.display = 'none';
    slide.style.transition = 'none';
    slide.style.left = '-100vw';
    void slide.offsetWidth;
    <!DOCTYPE html>
    <html lang="ja">
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>12</title>
    <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: black;
    }
    .container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
    }
    #jpgLayer, #pngLayer, #slideLayer, #gifLayer, #gifLayerM {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
    }
    #pngLayer, #slideLayer {
      object-fit: fill;
    }
    #gifLayer, #gifLayerM {
      object-fit: contain;
      z-index: 2;
      transition: left 6s cubic-bezier(0,0,0.2,1);
      pointer-events: none;
    }
    #slideLayer {
      z-index: 3;
    }
    #jpgLayer { z-index: 0; }
    #pngLayer { z-index: 1; }
    .button {
      position: absolute;
      top: 20px;
      padding: 10px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      background: rgba(0, 0, 0, 0.6);
      color: #fff;
      cursor: pointer;
      z-index: 20;
    }
    #backButton { left: 20px; }
    #nextButton { right: 20px; }
    </style>
    </head>
    <body>
    <div class="container" id="scene">
      <img src="12.png" id="pngLayer" alt="png">
      <img src="12.gif" id="gifLayer" alt="gif">
      <img src="12m.gif" id="gifLayerM" alt="gifm" style="display:none;">
      <img src="12a.png" id="slideLayer" alt="slide" style="display:none;">
      <img src="12.jpg" id="jpgLayer" alt="jpg">
    </div>
    <button class="button" id="backButton" onclick="history.back()">戻る</button>
    <button class="button" id="nextButton" onclick="location.href='13.html'">次へ</button>
    <script>
    (function () {
      const png = document.getElementById('pngLayer');
      const gif = document.getElementById('gifLayer');
      const gifM = document.getElementById('gifLayerM');
      const slide = document.getElementById('slideLayer');
      const scene = document.getElementById('scene');
      const animationDurationSec = 6;
      let state = 0; // 0:初期, 1:12a.png表示済, 2:gif右端, 3:gif消える
      let slideFixed = false;

      function resetAll() {
        gif.style.display = '';
        gifM.style.display = 'none';
        gif.src = "12.gif";
        gif.style.transition = 'none';
        gif.style.left = '0px';
        void gif.offsetWidth;
        gif.style.transition = `left ${animationDurationSec}s cubic-bezier(0,0,0.2,1)`;
        slide.style.display = 'none';
        slide.style.left = '0px';
        slideFixed = false;
        state = 0;
      }

      function showSlide12a() {
        // 12a.pngを12.pngと同じサイズ・位置で表示
        slide.style.display = '';
        slide.style.left = '0px';
        slide.style.width = png.offsetWidth + 'px';
        slide.style.height = png.offsetHeight + 'px';
        slideFixed = true;
        state = 1;
      }

      function moveGifRight() {
        gif.style.display = 'none';
        gifM.style.display = '';
        gifM.src = "12m.gif";
        gifM.style.transition = 'none';
        gifM.style.left = '0px';
        void gifM.offsetWidth;
        gifM.style.transition = `left ${animationDurationSec}s cubic-bezier(0,0,0.2,1)`;
        const checkReady = setInterval(() => {
          if (gifM.naturalWidth > 0) {
            clearInterval(checkReady);
            const scale = gifM.getBoundingClientRect().height / gifM.naturalHeight;
            const gifWidth = gifM.naturalWidth * scale;
            const rightStop = window.innerWidth - gifWidth;
            gifM.style.left = rightStop + 'px';
          }
        }, 100);
        state = 2;
      }

      function moveGifOut() {
        gifM.src = "12m.gif";
        const checkReady = setInterval(() => {
          if (gifM.naturalWidth > 0) {
            clearInterval(checkReady);
            const scale = gifM.getBoundingClientRect().height / gifM.naturalHeight;
            const gifWidth = gifM.naturalWidth * scale;
            const rightStop = window.innerWidth - gifWidth;
            gifM.style.transition = 'none';
            gifM.style.left = rightStop + 'px';
            void gifM.offsetWidth;
            gifM.style.transition = `left ${animationDurationSec}s cubic-bezier(0,0,0.2,1)`;
            gifM.style.left = window.innerWidth + 'px';
          }
        }, 100);
        state = 3;
      }

      window.addEventListener('load', resetAll);
      window.addEventListener('resize', () => {
        if (state === 0) resetAll();
        if (slideFixed) {
          slide.style.width = png.offsetWidth + 'px';
          slide.style.height = png.offsetHeight + 'px';
        }
      });

      scene.addEventListener('click', (e) => {
        if (e.target.closest('button')) return;
        if (state === 0) {
          showSlide12a();
        } else if (state === 1) {
          moveGifRight();
        } else if (state === 2) {
          moveGifOut();
        }
      });
      scene.addEventListener('touchstart', (e) => {
        if (e.target.closest('button')) return;
        if (state === 0) {
          showSlide12a();
        } else if (state === 1) {
          moveGifRight();
        } else if (state === 2) {
          moveGifOut();
        }
      });
    })();
    </script>
    </body>
    </html>
